<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body>
  <a href="https://github.com/dirkarnez/fake-data-generator" target="_blank">dirkarnez/fake-data-generator</a><br>
  <div id="container"></div>
  <button id="btn-generate">Generate</button>
  <script>
    const div = document.getElementById("container");
    const log = (...data) => div.innerHTML += `${data.join(String.fromCharCode(0x20))}<br>`;
    const error = (...data) => div.innerHTML += `<span style="color: red">${data.join(String.fromCharCode(0x20))}<span><br>`;
    log(1,2,3);
    error(1,2,3);
  </script>

  <script type="importmap">
  	{
  		"imports": {
  			"@faker-js/faker": "https://cdn.jsdelivr.net/npm/@faker-js/faker@10.2.0/+esm"
  		}
  	}
  </script>
  
  <script type="module">
    import { faker } from '@faker-js/faker';

    if (window.Worker) {
      const excelWorker = new Worker("excel-worker.js");
      excelWorker.addEventListener('message', function(e) {
        // postMessage({type: "export", value: u8 });
        if(e && e.data && e.data.type == "export") {
          e.stopPropagation();
          e.preventDefault();
          const data = e.data.value;
          const blob = new Blob([data], {type:"application/octet-stream"});
          const url = URL.createObjectURL(blob);
          const aHref = document.createElement("a");
          aHref.download = "SheetJSXPort.xlsx";
          aHref.href = url;
          document.body.appendChild(aHref);
          aHref.click();
        }
      });

      document.getElementById("btn-generate").addEventListener('click', function(e) {
        excelWorker.postMessage({
          type: "export",
          value: () => faker.helpers.multiple({
            userId: faker.string.uuid(),
            username: faker.internet.username(),
            email: faker.internet.email(),
            avatar: faker.image.avatar(),
            password: faker.internet.password(),
            birthdate: faker.date.birthdate(),
            registeredAt: faker.date.past(),
          }, {
            count: 5,
          })
        });
      });
    }

  </script>
</body>
</html>
